<% if has_coinbase_account_linked? %>
  <table id="transaction-history-table" class="table table-responsive table-hover table-condensed">
    <tbody>
      <% @history.each do |entry| %>
        <!-- TODO ignore request transactions for now -->
        <% next if entry['request'] %>
        <tr class="<%= entry['sender']['id'] == @coinbase_id ? 'danger' : 'success' %>">
          <td><%= (DateTime.parse(entry['created_at']).to_date == @previous_date.to_date rescue false) ? '' : DateTime.parse(entry['created_at']).strftime('%b %d') %></td>
          <td><%= friendly_amount_from_money(entry['amount']) %></td>
          <td><%= entry['sender']['id'] == @coinbase_id ? 'to' : 'from' %></td>
          <td><%= entry['recipient'] ? (CoinbaseAccount.find_by_email(entry['recipient']['email']).user.name rescue entry['recipient']['name']) : 'External Account' %></td>
        </tr>
        <% @previous_date = DateTime.parse(entry['created_at']) %>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>Click <%= link_to 'here', link_coinbase_account_path %> to link a Coinbase account first</p>
<% end %>
